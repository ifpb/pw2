---
title: Consumo do Supabase
---

import CodeTree from '../../../../components/CodeTree.astro';
import CodePreview from '../../../../components/CodePreview.astro';
import LibrarySelectorWrapper from '../../../../components/LibrarySelectorWrapper.astro';

# {frontmatter.title}

## JavaScript HTTP Clients

Existem várias formas de fazer requisições assíncronas em JavaScript. Veja as principais opções:

### Fetch API

[Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API) é a API nativa do navegador para requisições HTTP.

**Vantagens:**
- Nativa (sem dependências)
- Sintaxe moderna com Promises
- Suporta async/await

**Desvantagens:**
- Sem interceptadores
- Sem cancelamento nativo (precisa AbortController)
- Sem timeout

### Axios

[Axios](https://axios-http.com/) é uma biblioteca HTTP popular que funciona em navegador e Node.js.

**Vantagens:**
- Sintaxe simples e intuitiva
- Interceptadores integrados
- Suporta timeout e cancelamento
- Funciona em navegador e Node.js

**Desvantagens:**
- É uma dependência adicional (~13KB)

### Supabase Client

[@supabase/supabase-js](https://supabase.com/docs/reference/javascript/introduction) é a biblioteca oficial do Supabase para JavaScript.

**Vantagens:**
- Integração direta com Supabase
- Gerenciamento de autenticação automático
- Type-safe com TypeScript
- Realtime subscriptions

**Desvantagens:**
- Específico para Supabase
- Curva de aprendizado maior

## Demonstração

<LibrarySelectorWrapper>
  <div class="library-content-fetch active">
    Fetch API

    ```js
    fetch(resource)
    fetch(resource, options)
    ```

    Exemplo

    <CodePreview src="/codes/w3c/fetch-api/via-cep/index.js" />

    [Cross-Origin Resource Sharing (CORS)](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)

    - Access-Control-Allow-Origin
    - Access-Control-Allow-Methods
    - Access-Control-Allow-Headers
    - Access-Control-Allow-Credentials
    - Access-Control-Max-Age

    O [Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API) é uma alternativa ao [XMLHttpRequest](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest)
  </div>
  <div class="library-content-axios">
    Axios Library: [axios](https://axios-http.com/)

    ```bash
    $ npm install axios
    ```

    <CodePreview src="/codes/package/axios/via-cep/index.js" />
  </div>
  <div class="library-content-supabase">
    Supabase Client: [@supabase/supabase-js](https://supabase.com/docs/reference/javascript/introduction)

    ```bash
    $ npm install @supabase/supabase-js
    ```

    Exemplo:

    ```js showLineNumbers=true
    import { createClient } from '@supabase/supabase-js';

    const supabase = createClient(
      'https://xyz.supabase.co',
      'public-anon-key'
    );

    const { data, error } = await supabase
      .from('investments')
      .select();

    console.log(data);
    ```
  </div>
</LibrarySelectorWrapper>

## Invest-app (CRUD)

Veja como implementar as operações CRUD (Create, Read, Update, Delete) com cada biblioteca:

![](/pw2/imgs/w3c/fetch-api/invest-app-crud.png)

<LibrarySelectorWrapper>
  <div class="library-content-fetch active">
    [Código Fonte Fetch](https://github.com/ifpb/pw2/tree/main/public/codes/w3c/fetch-api/invest-app/)

    <CodeTree src="/codes/w3c/fetch-api/invest-app/" />

    <CodePreview src="/codes/w3c/fetch-api/invest-app/.env.example" />

    ```js title="/codes/w3c/fetch-api/invest-app/js/services/storage.js" showLineNumbers=true
    const API_URL = import.meta.env.VITE_APP_SUPABASE_URL;
    const API_TOKEN = import.meta.env.VITE_APP_SUPABASE_KEY;

    async function create(resource, data) {}
    async function read(resource, id) {}
    async function update(resource, id, data) {}
    async function remove(resource, id) {}

    export default { create, read, update, remove };
    ```
  </div>
  <div class="library-content-axios">
    [Código Fonte Axios](https://github.com/ifpb/pw2/tree/main/public/codes/package/axios/invest-app/)

    <CodeTree src="/codes/package/axios/invest-app/" />

    <CodePreview src="/codes/package/axios/invest-app/.env.example" />

    ```js title="/codes/package/axios/invest-app/js/services/storage.js" showLineNumbers=true
    import API from '/services/api.js';

    async function create(resource, data) {}
    async function read(resource, id) {}
    async function update(resource, id, data) {}
    async function remove(resource, id) {}

    export default { create, read, update, remove };
    ```

    Axios Config:

    <CodePreview src="/codes/package/axios/invest-app/js/services/api.js" />

  </div>
  <div class="library-content-supabase">
    [Código Fonte Supabase Client](https://github.com/ifpb/pw2/tree/main/public/codes/package/supabase-client/invest-app/)

    <CodeTree src="/codes/package/supabase-client/invest-app/" />

    <CodePreview src="/codes/package/supabase-client/invest-app/.env.example" />

    ```js title="/codes/package/supabase-client/invest-app/js/services/storage.js" showLineNumbers=true
    import { createClient } from '@supabase/supabase-js';

    const API_KEY = import.meta.env.VITE_APP_SUPABASE_KEY;
    const API_URL = import.meta.env.VITE_APP_SUPABASE_URL;

    const supabase = createClient(API_URL, API_KEY);

    async function create(resource, data) {}
    async function read(resource, id) {}
    async function update(resource, id, data) {}
    async function remove(resource, id) {}

    export default { create, read, update, remove };
    ```
  </div>
</LibrarySelectorWrapper>

### Create a investment

![](/pw2/imgs/package/supabase-api/post-investment.png)

<LibrarySelectorWrapper>
  <div class="library-content-fetch active">
    <CodePreview src="/codes/w3c/fetch-api/invest-api-doc/create.js" />
  </div>
  <div class="library-content-axios">
    <CodePreview src="/codes/package/axios/invest-api-doc/create.js" />
  </div>
  <div class="library-content-supabase">
    <CodePreview src="/codes/package/supabase-client/invest-api-doc/create.js" />
  </div>
</LibrarySelectorWrapper>

```js showLineNumbers=true
import Storage from './services/storage.js';

const investment = {
  name: "Tesouro Selic 2029",
  value: 10000,
  origin: "Tesouro Direto",
  category: "Pós",
  interest: "100% Selic",
  created_at: "2021-09-10T00:00:00-03:00",
};

Storage.create('investments', investment);
```

### Read investments

![](/pw2/imgs/package/supabase-api/get-investments.png)

<LibrarySelectorWrapper>
  <div class="library-content-fetch active">
    <CodePreview src="/codes/w3c/fetch-api/invest-api-doc/read.js" />
  </div>
  <div class="library-content-axios">
    <CodePreview src="/codes/package/axios/invest-api-doc/read.js" />
  </div>
  <div class="library-content-supabase">
    <CodePreview src="/codes/package/supabase-client/invest-api-doc/read.js" />
  </div>
</LibrarySelectorWrapper>

```js showLineNumbers=true
import Storage from './services/storage.js';

Storage.read('investments');
Storage.read('investments', 1);
```

### Update a investment

![](/pw2/imgs/package/supabase-api/patch-investment.png)

<LibrarySelectorWrapper>
  <div class="library-content-fetch active">
    <CodePreview src="/codes/w3c/fetch-api/invest-api-doc/update.js" />
  </div>
  <div class="library-content-axios">
    <CodePreview src="/codes/package/axios/invest-api-doc/update.js" />
  </div>
  <div class="library-content-supabase">
    <CodePreview src="/codes/package/supabase-client/invest-api-doc/update.js" />
  </div>
</LibrarySelectorWrapper>

```js showLineNumbers=true
import Storage from './services/storage.js';

Storage.update('investments', 1, { value: 15000 });
```

### Delete a investment

![](/pw2/imgs/package/supabase-api/delete-investment.png)

<LibrarySelectorWrapper>
  <div class="library-content-fetch active">
    <CodePreview src="/codes/w3c/fetch-api/invest-api-doc/delete.js" />
  </div>
  <div class="library-content-axios">
    <CodePreview src="/codes/package/axios/invest-api-doc/delete.js" />
  </div>
  <div class="library-content-supabase">
    <CodePreview src="/codes/package/supabase-client/invest-api-doc/delete.js" />
  </div>
</LibrarySelectorWrapper>

```js showLineNumbers=true
import Storage from './services/storage.js';

Storage.remove('investments', 1);
```
